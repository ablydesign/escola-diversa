var PAGE = PAGE || {};
(function($, document, window) {

	PAGE.address = null;
	PAGE.shipping = null;
	PAGE.payment = {
		rate: 0,
		sub: 0,
		quant: 1
	}

	PAGE.get_cookie = function(cname) {
		var name = cname + "=";
		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
		for(var i = 0; i <ca.length; i++) {
			var c = ca[i];
			while (c.charAt(0) == ' ') {
				c = c.substring(1);
			}
			if (c.indexOf(name) == 0) {
				return c.substring(name.length, c.length);
			}
		}
		return '';
	}

	PAGE.ajax_setup = function() {
		var _lang = (PAGE.get_cookie('wp_current_lang')) ? PAGE.get_cookie('wp_current_lang') : 'en_US';
		$.ajaxSetup({
			data: {
				lang: _lang
			}
		});
	}

	PAGE.field_required = function($form) {
		var _errors = 0;
		$form.find('input.required').each(function() {
			var _val = $(this).val();
			if (_val.length == 0) {
				$(this).addClass('error');
				++_errors;
			} else {
				$(this).removeClass('error');
			}
		});
		return _errors;
	}

	PAGE.load_lang = function() {
		if (!PAGE.get_cookie('wp_current_lang') && !PAGE.get_cookie('wp_current_lang').length) {
			PAGE.modal_lang();
		}

		if ($('.lang-target').length) {
			$('.lang-target').on('click', function() {
				PAGE.modal_lang();
			});
		}
	}

	PAGE.modal_lang = function() {
		$.fancybox.open({
			src  : '#modal-lang',
			type : 'inline',
			opts : {
				modal: true,
				baseClass: 'wp-modal-lang',
				animationEffect: 'zoom-in-out'
			}
		});
	}

	PAGE.banner_accordion = function() {
		if ($('#banner-home_accodrion').length) {
			const _length = $('#banner-home_accodrion').find('.banner-item').length;
			const _width  = $('#banner-home_accodrion').width();
			const _width_header = $('#banner-home_accodrion').find('.banner-item').first().find('.banner-item_header').width();
			const _width_content = _width - ((_width_header) * _length) - 85;

			$('#banner-home_accodrion').find('.banner-item').first().addClass('open');
			$('#banner-home_accodrion').find('.banner-item').first().find('.banner-item_content').width(_width_content+'px');

			$('.banner-item_header').on('click', function(e) {
				var $item = $(this).closest('.banner-item');

				$('.banner-item').removeClass('open');
				$('.banner-item').find('.banner-item_content').width(0);
				
				$item.addClass('open');
				$item.find('.banner-item_content').width(_width_content);
			});
		}
	}

	PAGE.listener_menu = function() {
		$('#menu-target').on('click', function() {
			$('#menu-target').toggleClass('open');
			$('#menu-content').toggleClass('show');
		});
	}

	PAGE.nav_scroll = function () {
		$(window).on('scroll', function () {
			var current_position = $(this).scrollTop();
			if (current_position > 400) {
				$('#header').addClass('fixed');
			} else {
				$('#header').removeClass('fixed');
			}
		});
	}

	PAGE.target_link = function() {
		$('body').find('a[href^="#"]').on('click', function (event) {
			event.preventDefault();
			var $el = $(this);
			var id = $el.attr('href');

			$('html, body').animate({
				scrollTop: $(id).offset().top - 200
			}, 2000);

			return false;
		});
	}

	PAGE.depoiments_home = function() {
		if ($('#depoiments-init').length) {
				$('#depoiments-init').slick({
					slidesToShow: 2,
					slidesToScroll: 1,
					autoplay: false,
					autoplaySpeed: 2000,
					infinite: false,
					arrows: true,
					dots: false,
					prevArrow:'<button type="button" class="btn-slick slick-prev">prev</button>',
					nextArrow:'<button type="button" class="btn-slick slick-next">next</button>'
				}).on('setPosition', function (event, slick) {
					slick.$slides.css('height', slick.$slideTrack.height() + 'px');
					slick.$slides.find('> div').css('height', slick.$slideTrack.height() + 'px');
				});
		}
	}

	PAGE.clamp = function() {
		if ($('.clamp').length) {
			$('.clamp').each(function(){
				var text = $(this).find('p')[0];
				var lines = parseInt($(this).attr('data-lines'));
				console.log('lines', lines);
				$clamp(text, {clamp: lines});
			});
		}
	}

	PAGE.ideas_masonry = function() {
		if ($('#ideas-list_masonry').length) {
			$('#ideas-list_masonry').find('.ideas-column.even').first().addClass('first-of-type');
			$('#ideas-list_masonry').find('.ideas-column.odd').first().addClass('first-of-type');
			setTimeout(function() {
				$('#ideas-list_masonry').masonry({
					itemSelector: '.ideas-column'
				});
			}, 0);	
		}
	}

	PAGE.ajax_more_diversity_request = function() {
		if ($('#home_school-diverse').length) {
			console.log('home_school-diverse 1');
			$('a.ajax-more-diversity').on('click', function(e) {
				console.log('ajax-school-diverse');
				e.preventDefault();
				var ajax_src = $(this).attr('data-src');
				PAGE.ajax_fancybox(ajax_src, '');
			});
		}
	}

	PAGE.ajax_fancybox = function(ajax_src, className) {
		$.fancybox.open({
			src  : ajax_src,
			type : 'ajax',
			opts : {
				protect: true,
				// modal: true,
				infobar: false,
				toolbar: false,
				slideClass: "fancybox-ajax-content",
				baseClass: "fancybox-ajax-container " + className,
			}
		});
	}

	PAGE.laod = function () {
		PAGE.ideas_masonry();
	};

	PAGE.init = function () {
		console.log('PAGE.init');
		$(window).load(PAGE.laod());
		
		PAGE.depoiments_home();
		PAGE.banner_accordion();
		PAGE.clamp();

		PAGE.ajax_more_diversity_request();
	};

})(jQuery, document, window);

PAGE.init();
var YOUTUBE = YOUTUBE || {};

(function($, document, window) {

  YOUTUBE.loop = function() {
    if($('[data-youtube]').length) {
      $('[data-youtube]').each(function(element, index) {
        if ($(this).attr('data-youtube').length)
          $(this).youtube_background({
            'play-button': true
          });
      });
    }
  };
  
  YOUTUBE.init = function() {
    YOUTUBE.loop();
  };

})(jQuery, document, window);

YOUTUBE.init();